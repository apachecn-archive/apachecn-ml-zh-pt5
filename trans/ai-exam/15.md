<title>Chapter_15</title>

# 15

# 建立一个认知的 NLP UI/CUI 聊天机器人

仅在脸书就有 30 多万个聊天机器人。除非你给你的聊天机器人一个目的，给它提供真正的内容，否则在那堵墙上再加一块砖几乎没有任何意义。认知内容代表了比你的成千上万的竞争对手和 SEO 专家吸引更多注意力的核心目标。我们将在本章中使用 RBM-PCA 链式算法，将聊天机器人带到另一个高度。我们将使用 RBM PCA 提供的信息来设计我们的对话。

正如您将在第一部分中发现的，使用 Dialogflow 创建代理并开始对话根本不需要任何努力。Google Dialogflow 提供了直观的特性，可以让聊天机器人立刻运行起来。Dialogflow 教程可以指导你在几分钟内达到这个简单的目标。理解什么是智能体，教它问一个问题，提供一个答案，一个 10 岁的孩子都能做到。我通过让一个 5 岁和一个 9 岁的孩子玩这个软件来做实验。他们都没有意识到这是工作。他们玩得很开心！

在 Dialogflow 上，你不需要知道如何编程，也不需要成为语言学家或任何其他类型的专家。那么，你的市场差异化会是什么？*内容*。你的聊天机器人需要有目的，除了简单的提问和回答，还要有准备充分的内容。

除了创建你的第一个对话框之外，本章的目标是给你一种目的感和内容感，这将帮助你创建有意义的聊天机器人。

也就是说，让我们一起创建一个代理和一个简短的对话来演示如何创建聊天机器人以及提供有意义的内容。

本章将涵盖以下主题:

*   基于*第 14 章*、*的准备工作创建一个认知代理，准备聊天机器人的输入，使用受限波尔兹曼机器(RBMs)和主成分分析(PCA)*
*   学习 Dialogflow 和聊天机器人的基本概念
*   在您的网站上部署聊天机器人

我们将从基本概念开始，然后创建一个具有实体、意图、对话和履行功能的代理。我们将使用前一章中建立的准备。我们将用拼写纠正和对话框来测试它的用户界面。然后，我们将通过设置机器学习语音识别和语音功能来测试聊天机器人的**对话式用户界面** ( **CUI** )能力。

# 基本概念

在创建代理之前，我们需要了解一些基本概念。

这不是一个 Dialogflow 课程，而是一个介绍性的章节，让我们开始制作自己的 NLP CUI 聊天机器人。我们将从定义一些关键术语开始。

## 定义 NLU

**NLU** 意为**自然语言理解**。NLU 是**自然语言处理** ( **NLP** )的子集。自然语言是指我们使用的日常语言，而不必为了从机器中获取信息而强迫自己学习精确的单词。

如果我们必须学习一个字典，里面只有能和系统一起工作的单词，那么阅读一篇文章会更容易。自然语言处理涵盖了包括 NLU 在内的所有形式的自然语言处理。通过人工智能，NLU 越来越多地试图理解一个特定句子的意思。

## 为什么我们称聊天机器人为“代理”？

聊天机器人需要至少两方进行聊天。在我们的例子中，机器人是一个 NLU 模块。这不是一个很好的营销方式。听起来像是:“你现在正在和一个 NLU 模块说话。”你不能假装机器人是人。*特工*这个词给人的印象是商业特工，体育特工，或者秘密特工，很神秘！它的意思是收集信息的计算机系统。现在它是一个具有 NLU 能力的 NLP 代理。

## 创建代理以理解对话流

学习 Dialogflow 的最快方法是从头开始创建一个对话框。登录 Dialogflow 并转到控制台。以下是 Dialogflow 的仪表盘截图的一部分。您可以在右上角看到控制台的链接:

![](img/B15438_15_01.png)

图 15.1:访问 Dialogflow 的控制台

一旦你点击**进入控制台**，如果你还没有登录，你将被要求登录。谷歌帐户是一个先决条件:

![](img/B15438_15_02.png)

图 15.2:用谷歌账户登录

按照登录说明进行操作并登录后，您将到达 Dialogflow 控制台。

单击右上角的下拉列表，无论显示的是哪个默认代理。将显示现有或默认代理的列表:

![](img/B15438_15_03.png)

图 15.3:代理列表

向下滚动列表，直到到达**创建新代理**(如果没有，点击**创建代理**选项)。点击**创建新代理**，将出现以下窗口:

![](img/B15438_15_04.png)

图 15.4:输入代理人姓名

给代理`Agent + <your name or initials>`打电话，确保你会有一个唯一的名字。这一章我就叫这个`cogfilmdr`。因此，本章中的代理人将被称为`cogfilmdr`。让 Google 创建一个默认的以英语为主要语言的代理结构。

完成后，点击左上角的设置按钮:

![](img/B15438_15_05.png)

图 15.5:设置按钮

您将进入代理的配置窗口。

目前，我们只有一个重要的选项需要检查。API 的版本必须是 V2 API。V1 API 将于 2020 年 3 月关闭:

![](img/B15438_15_06.png)

图 15.6:使用 V2 API

现在已经创建了代理，我们可以创建实体了。

## 实体

大多数聊天机器人教程首先解释意图。我不同意。一旦你知道你要去哪里，在这种情况下，选择一部基于*第 14 章*、*的电影，用受限玻尔兹曼机器(RBMs)和主成分分析(PCA)* 准备聊天机器人的输入，在建立你的结构之前建造一些砖块是有意义的。

Dialogflow(或任何聊天机器人)使用实体来提取用户话语(不一定是句子)中的有用信息，以了解他们的动机。

我们将使用在第 14 章中创建的实体。我们将首先创建一个名为`movies`的实体，它将包含在*第 14 章*中使用的 10 部目标电影。

```
 titles=["24H in Kamba","Lost","Cube Adventures",

            "A Holiday","Jonathan Brooks",

            "The Melbourne File", "WNC Detectives",

            "Stars","Space L","Zone 77"] 
```

点击窗口左侧的**实体**:

![](img/B15438_15_07.png)

图 15.7:对话流菜单

然后，点击**上的创建实体**:

![](img/B15438_15_08.png)

图 15.8:创建一个实体

您将被要求提供一个实体名称:

![](img/B15438_15_09.png)

图 15.9:输入实体名称

输入`movies`。在保存实体之前，我们必须输入我们选择的电影:

![](img/B15438_15_10.png)

图 15.10:实体列表

您会注意到，一旦添加了电影，就会自动填充一个默认的同义词。如果你愿意，可以添加其他同义词。

一旦输入了标题，点击**保存**按钮，这是必须的(不是自动保存界面):

![](img/B15438_15_11.png)

图 15.11:保存实体

我们现在将创建特征实体。第 14 章中`RBM.py`程序的特点如下:

```
# Each column is a feature. There are 6 features: ['love', 'happiness', 'family', 'horizons', 'action', 'violence'] 
```

我们将其命名为`features`，遵循与`movies`实体相同的过程，然后单击**保存**:

![](img/B15438_15_12.png)

图 15.12:创建特征实体

点击你的代理下的**实体**，你会看到该代理的实体列表，如下图所示:

![](img/B15438_15_13.png)

图 15.13:实体列表

如果您单击某个实体，将会出现一个可能选项的列表。

既然你的代理知道电影和特征实体，创建意图是有意义的。

## 意图

意图是明确表达做某事的意图。我给代理取名`cogfilmdr`。对于代理来说，用户的意图可能是要求看一部电影。

为了触发响应，我们必须输入训练短语。

**训练短语**是用户将通过文本或语音输入的单词组。你输入的句子越多，你的聊天机器人就会变得越好。这就是为什么如果现有的代理能够满足您的需求，那么从现成的 Dialogflow 开始是有意义的。

为了创建我们的示例对话框，我们将使用 GitHub 上提供的数据集结果，用于*第 14 章*、*使用受限波尔兹曼机器(RBMs)和主成分分析(PCA)* 准备聊天机器人的输入。我们已经提取了主要术语及其在 TensorBoard 上显示的特征。当我们从 RBM 提取数据时，我们对要素进行了如下排序:

```
Love: 643

Happiness: 2267

Family: 0

Horizons: 1521

Action: 2976

Violence: 4594 
```

我们在主成分分析中显示特征空间:

![](img/B15438_15_14.png)

图 15.14:特征的张量板表示

**提醒**:如果`RBM_launcher.py`再次运行，这个结果自然会改变，因为这是一个随机的观众-电影选择过程。

当开始一个聊天机器人项目时，最好非常小心地直接自动生成对话框。最好是从一个简单的、结构良好的聊天机器人开始，它只能完成有限的任务。我称之为“封闭聊天机器人”,意思是我们控制对话的每一个方面。一个“开放式聊天机器人”意味着信息自动流入以创建自动对话。在使用人工智能算法准备的信息让聊天机器人作为“封闭聊天机器人”运行一段时间后，这可能是一个目标。

我们在*第 14 章*中所做工作的结果提供了关于我们针对聊天机器人的市场细分的有趣信息。

暴力和动作指向动作片。家庭=0 分比较年轻的观众，比如青少年，对动作比组建家庭更感兴趣。发现快乐和爱是他们寻找的视野的一部分。这是典型的超级英雄系列和电影。超级英雄通常是孤独的个体。

我们现在将通过进入**意向**窗口创建一个意向:

![](img/B15438_15_15.png)

图 15.15:选择意图选项

出现**意图**窗口。点击**创建意图**:

![](img/B15438_15_16.png)

图 15.16:创建意图

“意向”窗口将出现，通过几个步骤创建一个问答对话框:

*   首先，输入`choose_movie`作为意图的名称。
*   然后，在“培训短语”部分，输入:“我想看你的一部电影。”

此时，我们有了一个意向名称和一个可能的用户问题:

![](img/B15438_15_17.png)

图 15.17:输入意图信息

现在，我们需要根据从第 14 章的*中提取的该细分市场的统计数据提供一个响应。我们将使用动作这个词来涵盖一部包含暴力和大团圆结局的电影，就像典型的超级英雄电影一样。为此，向下滚动到**文本响应**部分添加一个响应，并输入“你想看一部动作片吗？”，如以下截图所示:*

![](img/B15438_15_18.png)

图 15.18:输入文本响应

现在我们有了一个基本的对话框，让我们保存并测试它。为此，请转到控制台窗口右上角的测试控制台:

![](img/B15438_15_19.png)

图 15.19:测试控制台

我们可以使用 CUI 或文本:

*   **Text dialog**: Enter the user phrase: "I would like to watch one of your movies."

    用户看到代理的回答会很惊讶，是“想看动作片吗？”

![](img/B15438_15_20.png)

图 15.20:响应

这个建议对用户来说是一个惊喜，可能看起来很奇怪。这是因为我们用来准备对话的 RBM-PCA 方法瞄准了一个细分市场。

高级机器学习缩短了用户请求到满意响应的路径。对于用户来说，这是一个既省时又节能的过程。

*   **崔**:点击测试控制台上的麦克风图标。请确定这个麦克风是授权的，否则它将无法工作:

![](img/B15438_15_21.png)

图 15.21:麦克风

当你点击麦克风，这将触发你的请求记录。说，“我想看你的一部电影。”然后，点击停止按钮停止录制。对请求的响应将会出现:

![](img/B15438_15_22.png)

图 15.22:文本响应

要回答这个问题，我们需要使用 Dialogflow 的上下文功能。

## 语境

Context 表示 Dialogflow 将记住一个对话并使用后续交换，而不是每次都从头开始。

用户要求看电影，机器人建议看动作片。机器人在继续对话时会通过上下文记住这一点。

在菜单中点击代理的**意图**，悬停在**选择 _ 电影**上。您将看到**添加跟进意图**出现。这意味着可以存储主要意图的所有变量，并添加一个后续意图，它会记住之前说过的话，就像我们在对话中一样。

点击**添加跟进意向**:

![](img/B15438_15_23.png)

图 15.23:添加跟进意向按钮

在这种情况下，代理计划了两种情况，*是*或*否*。我们将在本章探讨*是*的答案，以及更复杂的*否*的答案*第十六章*、*改善聊天机器人的情商缺陷*。

在*第 14 章*中，我们用电影标题和特征创建了一个电影特征矩阵:

```
 # Part I Feature extractions from data sources

    # The titles of 10 movies

    titles=["24H in Kamba","Lost","Cube Adventures",

            "A Holiday","Jonathan Brooks",

            "The Melbourne File", "WNC Detectives",

            "Stars","Space L","Zone 77"]

    # The feature map of each of the 10 movies. Each line is a movie.

    # Each column is a feature. There are 6 features: ['love', 'happiness', 'family', 'horizons', 'action', 'violence']

    # 1= the feature is activated, 0= the feature is not activated

    movies_feature_map = np.array([[1,1,0,0,1,1],

                                   [1,1,0,1,1,1],

                                   [1,0,0,0,0,1],

                                   [1,1,0,1,1,1],

                                   [1,0,0,0,1,1],

                                   [1,1,0,1,1,0],

                                   [1,0,0,0,0,0],

                                   [1,1,0,1,1,0],

                                   [1,1,0,0,0,1],

                                   [1,0,0,1,1,1],

                                   [1,1,0,0,1,0],

                                   [1,1,0,1,1,1],

                                   [1,1,0,0,1,1]]) 
```

我们现在需要将这些信息转换到一个图表中，我们可以用它来增加对话的内容深度:

| **电影/故事片** | 爱 | 快乐 | 家庭的 | 地平线 | 行为 | 暴力 |
| 坎巴的 24H | 一 | 一 | 0 | 0 | 一 | 一 |
| 遗失 | 一 | 一 | 0 | 一 | 一 | 一 |
| 立方体冒险 | 一 | 0 | 0 | 0 | 0 | 一 |
| 一个假期 | 一 | 一 | 0 | 一 | 一 | 一 |
| 乔纳森·布鲁克斯 | 一 | 0 | 0 | 0 | 一 | 一 |
| 墨尔本档案 | 一 | 一 | 0 | 一 | 一 | 0 |
| WNC 侦探 | 一 | 0 | 0 | 0 | 0 | 0 |
| 明星 | 一 | 一 | 0 | 一 | 一 | 0 |
| 空格 L | 一 | 一 | 0 | 0 | 0 | 一 |
| 77 区 | 一 | 0 | 0 | 一 | 一 | 一 |

我们已经给了用户一点惊喜，直接推荐了一部动作片，而没有经过冗长的列表。我们使用通过输入、中间人工智能输出和最终输出获得的所有信息。

现在，我们更进一步，过滤符合 RBM-主成分分析链式算法提取的动作-暴力-快乐特征的电影。

图表中只有以下部电影符合动作-暴力-快乐:

*   坎巴的 24H
*   遗失
*   一个假期
*   77 区

我们会随机选择“77 区”一旦我们输入了许多可能性，可以在响应区域或脚本中建议一个随机选择。这种发展超出了本章的范围。对于这个例子，我们假设观众可能会对我们的建议感到满意。我们处在一个*是*的对话场景中。在*第十六章*、*改善聊天机器人的情商缺陷*中，我们将探讨这个对话的*否*场景，这需要更多的认知设计来保持满足路径较短。

目前，让我们建议“77 区”为此:

1.  点击**添加跟进意向**。
2.  选择**是**。

现在，您有了一个链接到该对话的跟进意向:

![](img/B15438_15_24.png)

图 15.24:跟进意图

点击**选择 _ 电影-是**。意向会出现。您会注意到 Dialogflow 已经在**培训短语**部分填写了几个形式的 *yes* ，如以下截图所示:

![](img/B15438_15_25.png)

图 15.25:训练短语

在这种情况下，剩下要做的就是向下滚动到**响应**部分，添加我们的答案:

![](img/B15438_15_26.png)

图 15.26:文本响应

现在，我们回到意图，并添加一个*是*后续跟进，以处理观众的*是*回答，就像我们之前做的那样:

![](img/B15438_15_27.png)

图 15.27:跟进意图

现在，我们点击 **choose_movie - yes - yes** ，就会看到 Dialogflow 为我们准备的 *yes* 答案:

![](img/B15438_15_28.png)

图 15.28:跟进意图的训练短语

然而，这一次，我们想用一个脚本来回答，而不是我们输入的答案。

要做到这一点，我们可以使用满足感。

# 向代理添加实施功能

在日常生活中，对话会很快变得无聊，在聊天机器人中更是如此。当我们开始猜测一个对话者要说的每一件事时，我们的思维慢慢地游离了。我们无能为力。人类是一个好奇的物种。**完成**将改变对话框的视角。这就是我所说的*目的*超越了实用主义的方法，即实现为对话添加了业务逻辑。

即使从实用的角度来看，要使对话可持续，它必须让用户足够兴奋，希望它回来并发现更多关于你的聊天机器人的信息，而不仅仅是从它那里获得商业信息。

如果你在字典中查找**fulfillment**，你会发现它的意思是提供快乐或满足，这正是你希望你的聊天机器人传达的目的感。

也就是说，为了达到这个目标，还有很多工作要做。Dialogflow 为用户、设计者和开发人员提供了一系列工具来满足他们的需求。

首先，Dialogflow 使用内置的无缝版本 Node.js 来实现功能。

## 定义履行

各种履行或附加对话框功能可用:

*   **Webhook**: A webhook is an event transmitted via HTTP. It is sent as a `POST`, which contains data posted to a predetermined URL. It works as an HTTP callback. The data sent to the URL will be parsed by a script on the server side. Once the service has processed the information, it will perform an action and send data back as a response.

    在这个例子中，我们不会使用 webhook。然而，值得注意的是，您可以使用 webhook 在另一个环境中创建自己的对话框。您甚至可以生成自动对话框，并从 Dialogflow 中调用它们。

    如果你对准备对话和上传对话感兴趣，你可以去屏幕左侧代理的**培训**页面上传短语:

![](img/B15438_15_29.png)

图 15.29:培训窗口

也可以上传一个代理，甚至是 Google Dialogflow 设计的预建代理。对于我们的例子，我们将使用行内编辑器。

*   **用 inline Node.js 编辑器实现**:定义一个 webhook URL 可能是最简单的方法。然而，使用行内编辑器提供了 Node.js 功能，甚至有更大的潜力。
*   **用内联 Node.js 编辑器和 Firebase 的云函数实现**:内联 Node.js 可以用几行省时的代码调用 Firebase 的大量云函数。

## 用实现 webhook 增强 cogfilmdr 代理

当用户回答*是*观看“Zone 77”时，我们可以用一个响应或一个网站链接来回答。要使用响应，请进入**意图**窗口中的“是-是”后续对话:

![](img/B15438_15_30.png)

图 15.30:意图和后续意图

点击 **choose_movie - yes - yes** 并向下滚动到**文本响应**并添加响应，如“当然，点击电影并观看”，如以下截图所示:

![](img/B15438_15_31.png)

图 15.31:文本响应

我们还可以通过激活**将此意图设置为对话结束**选项来决定这是最终结果，对话结束:

![](img/B15438_15_32.png)

图 15.32:对话结束选项

但我们暂时不会这样做；让我们进一步向下滚动来激活内嵌 webhook 功能:

![](img/B15438_15_33.png)

图 15.33:启用 webhook 功能

现在我们将转到**履行**窗口:

![](img/B15438_15_34.png)

图 15.34:访问实施界面

首先，启用行内编辑器:

![](img/B15438_15_35.png)

图 15.35:行内编辑器

为了给对话框增加一些乐趣，让我们假设聊天机器人在一个很酷的初创咖啡店里，在单独的屏幕上看电影是一项吸引顾客的服务。例如，您可以使用耳机(您、朋友、家人)观看电影。我们将这个服务添加到我们的对话框中。

我们转到脚本的`intentMap`并添加一个`gotomovie`函数:

```
let intentMap = new Map();

intentMap.set('Default Welcome Intent', welcome);

intentMap.set('Default Fallback Intent', fallback);

// intentMap.set('your intent name here', yourFunctionHandler);

// intentMap.set('your intent name here', googleAssistantHandler);

intentMap.set('choose_movie-yes-yes', gotomovie); 
```

推荐格式为`intentMap.set(<Intent>,<function>)`。

完成后，我们现在用自己的文本和网站链接编写函数:

```
function gotomovie(agent) {

    agent.add('This message is from Coffee Shop movie fans!');

    agent.add(new Card({

    title: 'A blog for Coffee Shops with movies to watch with friends and family',

    imageUrl: 'https://www.eco-ai-horizons.com/coffeeshop.jpg',

    text: 'The button takes you to the movie selection we have\n  Great to have you here! :-)',

    buttonText: 'Click here',

    buttonUrl: 'https://www.primevideo.com/'

    })

    );

} 
```

我们现在要做的就是点击**部署**，就这样！

我添加了一个链接到 Amazon Prime Video，以显示您可以使用 IBM Watson、Google、Microsoft、Amazon services 等来增强您的聊天机器人！

**重要提示**:你可以在这个编辑器中自定义所有你想要的对话框，并使用一系列谷歌云功能。天空甚至不是极限。你可以去火星！

对于我们的例子，一旦脚本已经部署，我们回到我们的对话的开始，直到我们到达这一点，这将把我们带到我们希望观看的电影。在这种情况下，我只是显示了一个流媒体网站。

您可以在`CH15`的 GitHub 上获取`dialogflowFulfillment.zip`中`index.js`的完整脚本，并将其复制到编辑器中，无需导入整个包。

## 让机器人在你的网站上工作

让我们点击几下鼠标，让一个机器人在你的网站上运行。

1.  向下滚动到**集成**，找到您想要部署的代理:您自己的代理或咖啡店代理。
2.  激活**网络演示**选项。
3.  嵌入的代码将出现在下面:

    ```
    <iframe height="430" width="350" src="img/81298e0c-1acb-44bb-9c68-89666805342a"></iframe> 
    ```

将代码复制到您希望实现它的网站页面上。

要先测试一下，你可以在你的浏览器里复制网址，测试一下。

**注意**:如果您在浏览器上激活了该站点的麦克风，您可以使用语音对话框。不要忘记使用`https`访问页面，否则麦克风可能会被阻塞。此外，如果没有一些额外的开发，就不能在这个 HTML 页面中激活实现。

然而，你也可以在控制台中点击谷歌助手，然后点击几下创建一个应用程序，然后将其部署在智能手机和谷歌主页上。如果你创建了一个漂亮的聊天机器人，你只需点击几下就可以让全世界的人使用它！

# 机器学习代理

如果没有对文本识别、话语、句子、语音、实体、意图和对话的许多其他方面的机器学习，NLP 聊天机器人就无法运行。

在本节中，我们将探讨以下内容:

*   语音转文本
*   文本到语音转换
*   拼写纠正

让我们看看如何在这些环境中应用机器学习。

## 在聊天机器人中使用机器学习

一般来说，当我们听到聊天机器人中的机器学习时，我们会想到一个在对话中运行的机器学习程序作为响应。

在这一节中，我们将重点关注如何使用机器学习来改进聊天机器人并使其工作。

## 语音转文本

如果没有语音转文本功能，你就无法在智能音箱上实现聊天机器人或任何语音应用，比如 Google Home 或 Amazon Echo。未来几年，智能音箱将在我们的生活中扮演越来越重要的角色。

点击代理名称旁边的设置按钮，然后点击**语音**:

![](img/B15438_15_36.png)

图 15.36:语音选项

我们将重点介绍语音识别功能的主要设置:

*   **增强语音模型**:这是企业版自带的高级机器学习选项。它显示了语音识别已经走了多远。在标准版本中，该系统已经运行良好。在高级版本中，它使用数据记录功能来增强语音识别。
*   **自动语音适应**:这个很有趣，因为这个函数使用创建的意图和实体来训练和适应代理对话的语音识别。它可以在免费版本中激活，如下所示:

![](img/B15438_15_37.png)

图 15.37:启用自动语音适应

离开此界面前保存设置。

## 文本到语音转换

现在，我们可以转到**语音**选项卡和启用**自动文本到语音**功能。我有一个云账户。如果你不能在实验室激活它，我们将使用免费的在线网站来测试机器学习算法的可能性和局限性。

**注**:有增强语音识别型号选项，但是你得升级到企业版。

点击代理名称旁边的设置按钮，然后点击**语音**:

![](img/B15438_15_38.png)

图 15.38:语音选项

我们将首先配置文本到语音转换的主要设置:

*   **代理语言**:从`en(English)`开始，达到最大受众。但是，请记住，Dialogflow 在几种语言中都能产生良好的语音效果。
*   **声音**:在尝试不同的 WaveNet 模型变化之前，从`Automatic`开始。WaveNet 模型利用神经网络从头开始构建声音。
*   **语速**:可以留在`1`，也可以加快语速或者放慢语速。例如，对于体育评论，它可以更快。
*   **音高**:您可以用半音调高或调低声音。
*   **音量增益**:您可以减小或增大音量。最好是让它在`0`开始。然后，在测试代理的同时，看看它是否需要更改。

一旦设置了这些参数，保存模型:

![](img/B15438_15_39.png)

图 15.39:语音配置

现在，输入一句话并点击**播放**按钮，测试您的配置或试验不同的设置:

![](img/B15438_15_40.png)

图 15.40:尝试不同的声音设置

一旦我们完成设置语音参数，我们需要设置拼写机器学习功能。

## 拼写

在探索谷歌提供的机器学习算法的可能性和局限性之前，我们还有一个步骤。需要激活机器学习拼写功能。

为此，我们将点击 **ML 设置**选项卡，激活**自动拼写纠正**，并定义一个可接受的阈值，低于该阈值我们的代理将拒绝识别错误。

点击代理名称旁边的设置按钮，然后点击 **ML 设置**:

![](img/B15438_15_41.png)

图 15.41: ML 设置选项卡

你将有访问各种选项来解决用户的拼写错误。例如，当我们输入错误的请求时，它就像搜索引擎的拼写校正器一样工作，谷歌会给出正确的拼写建议。

选项如下:

*   **ML 分类阈值**确定一个置信度得分，低于该得分的意图将不会被触发，除非存在回退意图(一般响应)。
*   **自动拼写纠正**使用机器学习来纠正用户的拼写错误。它应该被激活。
*   **自动训练**可能会降低对话速度，因此建议小心使用该功能。
*   **代理验证**在培训过程中自动验证代理。请注意，例如，每当您保存一个意向时，就会触发培训。

下面的屏幕截图显示了您可能希望开始使用的默认值:

![](img/B15438_15_42.png)

图 15.42: ML 设置选项

每次更改选项时，点击**训练**按钮。

## 为什么这些机器学习算法很重要？

如果它只是一个像`cogfilmdr`代理示例那样的教育性聊天机器人，那么错误是可以接受的。很不愉快，但是可以接受。正如我们将在*第 16 章*、*中看到的，改善聊天机器人的情商缺陷*，如果聊天机器人将被大量的人使用，这意味着许多天的训练、测试，以及为这些功能的机器学习限制创建变通办法。而且那只是针对一种语言！

如果我们使用多种语言进行部署，这意味着要用很多天的时间来增加语言的数量！即使有了机器学习，这也是一项艰巨的工作。没有机器学习，这是不可能的。

机器学习不仅重要；至关重要的是:

*   如果聊天机器人因为一个简单的拼写错误而无法识别书面话语，我们将会收到投诉和糟糕的评论，搜索引擎优化之船将会沉没。
*   如果聊天机器人不能识别你在 Google Home 或任何智能音箱上说的话，那就意味着很多麻烦，甚至可能会退款。
*   如果聊天机器人的回答听起来像 20 世纪的机器人，那么没有人会想使用它。

聊天机器人中的机器学习已经存在，但在情商方面还有待改进，就像我们现在必须在下一章探索的那样。

# 摘要

Google Dialogflow 在 Google Cloud 上提供了一整套工具来构建聊天机器人，为其添加服务，并根据您的认知程序对其进行定制。

好的聊天机器人符合要求。在开始开发之前全面考虑架构可以避免模型的欠适应(功能不足)或过适应(将不被使用的功能)。

仔细的人工智能准备，如第 14 章、*使用受限波尔兹曼机器(RBMs)和主成分分析(PCA)准备聊天机器人的输入*中所完成的，通过使从对话开始到对话目标的路径更短、更高效，为聊天机器人提供了坚实的基础。

确定正确的意图(对聊天机器人的期望)，确定描述意图的实体(短语和单词的子集)，以及创建适当的对话将花费相当多的时间。

如果有必要，添加服务和特别定制的机器学习功能将增强系统的质量。CUI 具有语音识别、语音对话和拼写纠正功能，使聊天机器人使用起来没有摩擦。

我们在本章中建立的对话是基于*是*的答案。我们假设第 14 章中*的 RBM 和 PCA 生成的概率是正确的。然而，人类并不容易局限于刻板印象。*

*第 16 章*、*改善聊天机器人的情商缺陷*，通过基本概念、对话流功能和认知方法来探索情商，以改善聊天机器人的内容。

# 问题

1.  聊天机器人能像人类一样交流吗？(是|否)
2.  聊天机器人一定是 AI 程序吗？(是|否)
3.  聊天机器人只需要文字交流。(是|否)
4.  人类只会用文字聊天吗？(是|否)
5.  人类只会用文字和数字来思考。(是|否)
6.  仔细的机器学习准备对于构建认知聊天机器人是必要的。(是|否)
7.  要让聊天机器人正常工作，需要规划对话流程。(是|否)
8.  聊天机器人拥有一般的人工智能，所以不需要预先开发。(是|否)
9.  除了翻译 API 之外，聊天机器人不需要任何功能就可以很好地翻译。(是|否)
10.  聊天机器人在大多数情况下已经可以像人类一样聊天了。(是|否)

# 进一步阅读

*   关于 Google Dialogflow 的更多信息，请参考这个链接:[https://dialogflow.com/](https://dialogflow.com/)
*   有关聊天机器人和 UI 开发的更多信息，请参考此链接:[https://www . packtpub . com/application-development/hands-chatbots-and-conversatile-UI-development](https://www.packtpub.com/application-development/hands-chatbots-and-conversational-ui-development)