<html><head/><body>
    
        <title>Personal and Home IoT</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">个人和家庭物联网</h1>
                
            
            
                
<p class="mce-root">既然你已经完全具备了<strong>机器学习</strong> ( <strong> ML </strong>)和<strong>深度学习</strong> ( <strong> DL </strong>)的知识，并且已经学会了如何将其用于大数据、图像任务、文本任务和时间序列数据，那么是时候探索一下所学算法和技术的一些真实用途了。本章和接下来的两章将集中讨论一些具体的案例研究。本章将关注个人和家庭<strong>物联网</strong> ( <strong> IoT </strong>)用例。我们将在本章中介绍以下内容:</p>
<ul>
<li>成功的物联网应用</li>
<li>可穿戴设备及其在个人物联网中的作用</li>
<li>如何使用 ML 监测心脏</li>
<li>什么让家成为智能家居</li>
<li>智能家居中使用的设备</li>
<li>人工智能在预测人类活动识别中的应用</li>
</ul>


            

            
        
    



    
        <title>Personal IoT</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">个人物联网</h1>
                
            
            
                
<p>个人物联网由可穿戴设备的使用主导，可穿戴设备是设计用于佩戴在身上的技术设备，它们与智能手机上的应用程序配合使用。第一款可穿戴设备是美国时代计算机公司(当时名为<strong>汉密尔顿手表公司</strong>)生产的 Pulsar 计算器手表。这是一个独立的设备，没有连接到互联网。很快，随着互联网的发展，可以连接互联网的可穿戴设备成为一种时尚。可穿戴设备市场预计将从 2016 年<strong>的<strong>3.25 亿</strong>T4</strong>亿跃升至 2020 年<strong>超过<strong>8.3 亿</strong> <strong>亿</strong>:</strong></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1108 image-border" src="img/11b5c44d-8c4c-4040-adeb-2c5498122d54.png" style="width:35.92em;height:24.08em;"/></p>
<p>这张图表显示了 2016 年至 2021 年全球可穿戴设备的数量(数据来源:Statista)。随着如此多的设备在线连接，不断产生数据，AI/ML 工具是分析这些数据并做出明智决策的自然选择。在本节中，您将了解一些成功的个人物联网应用。</p>
<p class="mce-root"/>


            

            
        
    



    
        <title>SuperShoes by MIT</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">麻省理工学院的超级运动鞋</h1>
                
            
            
                
<p>一手拿着手机，在<em>谷歌地图</em>的帮助下沿路导航，你有多少次觉得这很麻烦？你有多少次想要一双可以带你去任何你想去的地方的魔法拖鞋？麻省理工学院媒体实验室<em>的超级鞋</em>(<a href="https://www.media.mit.edu/projects/supershoes/overview/">https://www.media.mit.edu/projects/supershoes/overview/</a>)几乎就像那些魔法拖鞋；它们允许用户在人行道上导航，而无需查看智能手机屏幕。</p>
<p>超级鞋有弹性鞋垫，脚趾下嵌有振动马达。他们无线连接到智能手机上的一个应用程序。该应用程序不仅允许用户与超级运动鞋互动，还可以在云帐户中存储喜欢/不喜欢的东西、爱好、商店、食物、人、兴趣等。振动马达产生与用户交流的声音。一旦用户在应用程序上输入目的地，鞋子就会开始工作。如果左脚趾发痒，那么用户应该左转；如果右脚趾发痒，那么用户必须右转。当没有挠痒痒时，用户必须继续直线前进。如果两者都重复挠痒痒，那么用户已经到达了他们的目的地。</p>
<p>除了导航，还能推荐附近的名胜古迹；用户在云上更新他们的好恶。基于用户的喜欢和不喜欢，当用户靠近推荐的感兴趣的地方时，SuperShoe 还会给出指示(两个脚趾发痒一次)。超级鞋的另一个有趣的特点是，它也可以提醒人们；如果你在附近有任务，它会提醒你。</p>
<p>制作这款鞋所需的硬件非常简单，它需要以下:</p>
<ul>
<li>三个振动触觉挠痒器来挠脚趾</li>
<li>感应行走的电容垫</li>
<li>微控制器从应用程序中获取命令，并相应地控制备忘录</li>
<li>与智能手机连接的蓝牙设备</li>
<li>为整个系统供电的电池</li>
</ul>
<p>这种魔力是由编码在应用程序中的软件实现的。你可以在这个网站了解更多关于超级运动鞋的信息:<a href="http://dhairyadand.com/works/supershoes">http://dhairyadand.com/works/supershoes</a>。</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    



    
        <title>Continuous glucose monitoring</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">连续葡萄糖监测</h1>
                
            
            
                
<p>人工智能的一个主要应用是医疗保健的物联网，其中最成功的商业应用之一是连续监测人体的葡萄糖水平。Abbott 的 FreeStyle CGM、DexCom CGM 和 Medtronic CGM 是一些市售品牌。</p>
<p><strong>持续葡萄糖监测</strong> ( <strong> CGM </strong>)让糖尿病患者可以实时检查自己身体的葡萄糖水平。这有助于他们在一段时间内监测读数，这些数据还可以用于预测未来的血糖水平，从而帮助他们处理低血糖等情况。</p>
<p>在 CGM 中，通常传感器被放置在腹部皮肤下或贴在手臂背面。传感器将读数发送到连接的寻呼机/智能手机应用程序。该应用程序具有额外的基于人工智能的算法，可以通知用户任何临床相关的葡萄糖模式。该数据的可用性不仅有助于用户主动管理他们的血糖高低，而且还可以洞察膳食、锻炼或疾病对一个人的血糖水平的影响。</p>
<p>传感器的使用寿命从 7 天到 14 天不等，通常这段时间足以让医生了解患者的生活方式，并相应地提出改变建议。</p>


            

            
        
    



    
        <title>Hypoglycemia prediction using CGM data</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">使用 CGM 数据进行低血糖预测</h1>
                
            
            
                
<p>一旦一个人有了 CGM 数据，就可以使用 AI/ML 对其进行分析，以收集更多信息或做出关于低血糖的预测。在本节中，我们将看到如何使用我们在前面章节中学习的算法来制作一个葡萄糖预测系统。</p>
<p>我们将基于 Sparacino 等人(<a href="https://doi.org/10.1109/TBME.2006.889774" target="_blank"> 10.1109/TBME.2006.889774 </a>)的研究论文<em>构建我们的预测器，可以根据连续葡萄糖监测传感器时间序列</em>提前预测葡萄糖浓度。</p>
<p class="mce-root"/>
<p>本文用时间序列模型描述 CGM 时间序列葡萄糖数据；本文考虑了两种模型，一种是简单的一阶多项式模型，另一种是一阶自回归模型。相对于过去的葡萄糖数据，在每个采样时间<em>t<sub>s</sub>T3】拟合模型参数。这里，我们将使用 scikit 线性回归器实现简单的一阶多项式，我们在<a href="09538353-bf5b-4035-8b98-cc131bcfcf24.xhtml">第 3 章</a>、<em>物联网的机器学习</em>中了解到:</em></p>
<ol>
<li>我们导入模块 pandas 来读取<kbd>csv</kbd>文件，NumpPy 用于数据处理，Matplolib 用于绘图，scikit-learn 用于线性回归，如下所示:</li>
</ol>
<pre style="padding-left: 60px">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>from sklearn.linear_model import LinearRegression<br/>%matplotlib inline</pre>
<ol start="2">
<li>将从您的 CGM 获得的数据保存在 data 文件夹中并读取。我们需要两个值，葡萄糖读数及其时间。我们使用的数据在两个 CSV 文件中可用，<kbd>ys.csv</kbd>和<kbd>ts.csv</kbd>。第一个包含葡萄糖值，第二个包含相应的时间，如下所示:</li>
</ol>
<pre style="padding-left: 60px"># Read the data<br/>ys = pd.read_csv('data/ys.csv')<br/>ts = pd.read_csv('data/ts.csv')</pre>
<ol start="3">
<li>根据论文，我们定义了预测模型的两个参数<kbd>ph</kbd>、预测值<kbd>horizon</kbd>和遗忘因子<kbd>mu</kbd>。有关这两个参数的更多详细信息，请参考我们之前提到的论文:</li>
</ol>
<pre style="padding-left: 60px"># MODEL FIT AND PREDICTION<br/><br/># Parameters of the predictive model. ph is Prediction horizon, mu is Forgetting factor.<br/>ph = 10 <br/>mu = 0.98</pre>
<ol start="4">
<li>我们创建数组来保存我们的预测值，如下所示:</li>
</ol>
<pre style="padding-left: 60px">n_s = len(ys)<br/><br/># Arrays to hold predicted values<br/>tp_pred = np.zeros(n_s-1) <br/>yp_pred = np.zeros(n_s-1)</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="5">
<li>我们现在读取模拟实时采集的 CGM 数据，并预测未来<kbd>ph</kbd>分钟的血糖水平。所有过去的数据都用于确定模型参数，但是，每个数据都有不同的贡献，这取决于分配给它的个体权重<kbd>mu<sup>k</sup></kbd>(在实际采样时间之前的<kbd>k</kbd>瞬间采集的样本):</li>
</ol>
<pre style="padding-left: 60px"># At every iteration of the for loop a new sample from CGM is acquired.<br/>for i in range(2, n_s+1):<br/>    ts_tmp = ts[0:i]<br/>    ys_tmp = ys[0:i]<br/>    ns = len(ys_tmp)<br/> <br/>    # The mu**k assigns the weight to the previous samples.<br/>    weights = np.ones(ns)*mu<br/>    for k in range(ns):<br/>        weights[k] = weights[k]**k<br/>    weights = np.flip(weights, 0)<br/>    # MODEL<br/>    # Linear Regression.<br/>    lm_tmp = LinearRegression() <br/>    model_tmp = lm_tmp.fit(ts_tmp, ys_tmp, sample_weight=weights)<br/>    <br/>    # Coefficients of the linear model, y = mx + q <br/>    m_tmp = model_tmp.coef_<br/>    q_tmp = model<em>tmp.intercept<br/><br/></em>    # PREDICTION<br/>    tp = ts.iloc[ns-1,0] + ph<br/>    yp = m_tmp*tp + q_tmp<br/> <br/>    tp_pred[i-2] = tp <br/>    yp_pred[i-2] = yp</pre>
<ol start="6">
<li>我们可以看到预测落后于实际。正常葡萄糖水平在<kbd>70</kbd>到<kbd>180</kbd>范围内。低于<kbd>70</kbd>，患者可能会出现低血糖，高于<kbd>180</kbd>，患者可能会出现高血糖。让我们看看预测数据的图表:</li>
</ol>
<pre style="padding-left: 60px"># PLOT<br/># Hypoglycemia threshold vector. <br/>t_tot = [l for l in range(int(ts.min()), int(tp_pred.max())+1)]<br/>hypoglycemiaTH = 70*np.ones(len(t_tot)) <br/>#hyperglycemiaTH = 180*np.ones(len(t_tot))<br/> <br/>fig, ax = plt.subplots(figsize=(10,10))<br/>fig.suptitle('Glucose Level Prediction', fontsize=22, fontweight='bold')<br/>ax.set_title('mu = %g, ph=%g ' %(mu, ph))<br/>ax.plot(tp_pred, yp_pred, label='Predicted Value') <br/>ax.plot(ts.iloc[:,0], ys.iloc[:,0], label='CGM data') <br/>ax.plot(t_tot, hypoglycemiaTH, label='Hypoglycemia threshold')<br/>#ax.plot(t_tot, hyperglycemiaTH, label='Hyperglycemia threshold')<br/>ax.set_xlabel('time (min)')<br/>ax.set_ylabel('glucose (mg/dl)')<br/>ax.legend()</pre>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1109 image-border" src="img/df2045fe-1257-4d6e-84e0-713cd388dea0.png" style="width:40.08em;height:42.92em;"/></p>
<ol start="7">
<li>对于以下代码，RMSE 误差将为 27:</li>
</ol>
<pre style="padding-left: 60px">from sklearn.metrics import mean_squared_error as mse<br/>print("RMSE is", mse(ys[1:],yp_pred))</pre>
<p>代码位于<kbd>Chapter09/Hypoglycemia_Prediction.ipynb</kbd>笔记本上。葡萄糖预测系统可用于许多商业产品中。你也可以根据我们刚刚做的模型做一个。你也可以使用人工神经网络进行类似的预测，结果会更好(参考<a href="https://www.ncbi.nlm.nih.gov/pubmed/20082589">https://www.ncbi.nlm.nih.gov/pubmed/20082589</a>)。</p>


            

            
        
    



    
        <title>Heart monitor</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">心脏监护器</h1>
                
            
            
                
<p>AI 在物联网中的另一个非常有用的个人应用是在心脏病的检测中。有大量的可穿戴设备可以用来监测和记录心率。这些数据可以用来预测任何有害的心脏状况。这里，我们将采用 AI/ML 工具来预测心脏<strong>心律失常</strong>，这是一组心率不规则的情况；可能太快(每分钟 100 次以上)，也可能太慢(每分钟 60 次以下)。使用的数据取自<em>https://archive.ics.uci.edu/ml/datasets/heart+Disease<a href="https://archive.ics.uci.edu/ml/datasets/heart+Disease">库</a>的<em> UCI 机器学习 R</em>T5】库</em>数据集。数据集由 76 个属性组成，并非所有属性都是预测疾病存在所必需的；数据集有一个与每个数据行相关联的目标字段。它有五个可能的值 0-4，值 0 表示心脏健康，任何其他值表示有疾病。为了更准确，可以将问题分解成一个二元分类问题。该代码的灵感来自 Mohammed Rashad 的 GitHub 链接，它是在 GNU GPL 3.0 许可证下共享的:<a href="https://github.com/MohammedRashad/Deep-Learning-and-Wearable-IoT-to-Monitor-and-Predict-Cardiac-Arrhytmia">https://GitHub . com/Mohammed Rashad/Deep-Learning-and-Wearable-IoT-to-Monitor-and-Predict-cardiarhytmia</a>。完整的代码可以从 GitHub 库的<kbd>Chapter09/Heart_Disease_Prediction.ipynb</kbd>文件中获得:</p>
<ol>
<li>一如既往，第一步是导入必要的模块。由于我们现在将患者分类为患有心脏病或没有心脏病，我们将需要一个分类器。这里为了简单起见，我们使用了<kbd>SVC</kbd>分类器。您可以尝试使用 MLP 分类器，如下所示:</li>
</ol>
<pre style="padding-left: 60px"># importing required libraries<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>from sklearn.svm import SVC<br/>from sklearn import metrics<br/>from sklearn.metrics import confusion_matrix<br/>from sklearn.model_selection import train_test_split</pre>
<ol start="2">
<li>接下来，读取数据集，预处理数据集以选择您将考虑的属性。我们从 76 个属性中选择了 13 个属性，然后我们将目标从多类值转换为二进制类。最后，数据分为训练和测试数据集，如下所示:</li>
</ol>
<pre style="padding-left: 60px"># reading csv file and extracting class column to y.<br/>dataset = pd.read_csv("data.csv")<br/>dataset.fillna(dataset.mean(), inplace=True)<br/><br/>dataset_to_array = np.array(dataset)<br/>label = dataset_to_array[:,57] # "Target" classes having 0 and 1<br/>label = label.astype('int')<br/>label[label&gt;0] = 1 # When it is 0 heart is healthy, 1 otherwise<br/><br/># extracting 13 features<br/>dataset = np.column_stack((<br/>    dataset_to_array[:,4] , # pain location<br/>    dataset_to_array[:,6] , # relieved after rest<br/>    dataset_to_array[:,9] , # pain type <br/>    dataset_to_array[:,11], # resting blood pressure<br/>    dataset_to_array[:,33], # maximum heart rate achieve<br/>    dataset_to_array[:,34], # resting heart rate <br/>    dataset_to_array[:,35], # peak exercise blood pressure (first of 2 parts) <br/>    dataset_to_array[:,36], # peak exercise blood pressure (second of 2 parts) <br/>    dataset_to_array[:,38], # resting blood pressure <br/>    dataset_to_array[:,39], # exercise induced angina (1 = yes; 0 = no) <br/>    dataset.age, # age <br/>    dataset.sex , # sex<br/>    dataset.hypertension # hyper tension<br/> ))<br/><br/>print ("The Dataset dimensions are : " , dataset.shape , "\n")<br/><br/># dividing data into train and test data<br/>X_train, X_test, y_train, y_test = train_test_split(dataset, label, random_state = 223)</pre>
<ol start="3">
<li>现在，我们定义要使用的模型。这里我们使用支持向量分类器，使用<kbd>fit</kbd>函数来训练数据集:</li>
</ol>
<pre style="padding-left: 60px">model = SVC(kernel = 'linear').fit(X_train, y_train)</pre>
<ol start="4">
<li>让我们看看它在测试数据集上的性能:</li>
</ol>
<pre style="padding-left: 60px">model_predictions = model.predict(X_test)<br/># model accuracy for X_test <br/>accuracy = metrics.accuracy_score(y_test, model_predictions)<br/>print ("Accuracy of the model is :" , <br/>    accuracy , "\nApproximately : ", <br/>    round(accuracy*100) , "%\n")</pre>
<ol start="5">
<li>你可以看到它提供了 74%的准确率，使用 MLP，我们可以进一步提高它。但是一定要记住在使用 MLP 分类器之前归一化所有的输入特征。以下是我们在测试数据集上训练的支持向量分类器的混淆矩阵:</li>
</ol>
<pre style="padding-left: 60px">#creating a confusion matrix<br/>cm = confusion_matrix(y_test, model_predictions)<br/><br/>import pandas as pd<br/>import seaborn as sn<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>df_cm = pd.DataFrame(cm, index = [i for i in "01"],<br/>columns = [i for i in "01"])<br/>plt.figure(figsize = (10,7))<br/>sn.heatmap(df_cm, annot=True)</pre>
<p>以下输出显示了测试数据集的混淆矩阵:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/fe756965-f750-4f3a-a070-01330b4ac16d.png" style="width:39.25em;height:30.00em;"/></p>
<p>您可以在相同的数据集上训练您的模型，并使用您训练的模型来预测您的朋友、家人或客户的心脏状况。</p>


            

            
        
    



    
        <title>Digital assistants</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">数字助理</h1>
                
            
            
                
<p>数字助理是最古老的人工智能应用之一。最初对数字助理的尝试从未真正起飞。但是随着智能手机的出现和大规模普及，今天我们有大量的数字助理为您提供诸如拨打电话号码、编写短信、安排约会甚至搜索互联网等服务。你可以请他们推荐附近的餐馆和酒吧或其他类似的东西。</p>
<p class="mce-root"/>
<p>以下是一些流行的数字助理:</p>
<ul>
<li>Siri:由苹果公司开发，它允许用户发送/拨打电话，在日历中添加约会，播放音乐或视频，甚至发送文本。如今，几乎所有苹果产品上都有声控界面。</li>
<li>Cortana:由微软创建，它通过提醒你根据时间、地点甚至是人来做事情，从而帮助你按计划行事。你可以让 Cortana 为你预订午餐，或者使用它合作的任何其他应用程序。它集成了 Edge，并调用了一个配有 Cortana 的声控扬声器。</li>
<li><strong> Alexa </strong>:由亚马逊开发，这是亚马逊 Echo 智能音箱提供的。它可以播放音乐，制作待办事项列表，为您设置闹钟，播放有声书，并提供股票、天气等实时信息。它还能够进行语音交互。</li>
<li><strong>谷歌助手</strong>:这是一款语音控制的智能助手。它提供了持续的对话，也就是说，对于任何后续请求，你不必说<em>嘿，谷歌</em>，一旦你开始说话，它就会听到回应，而不需要触发短语。它还可以识别不同人的语音配置文件，并根据该人的个人喜好和厌恶来定制其响应。它不仅可以在 Android 智能手机上使用，也可以在 Google Home 上使用。</li>
</ul>
<p>2018 年，谷歌更进一步，发布了谷歌双工(Google Duplex)，这是一款可以为你打电话和预约的助手。它像人类一样说话，说话时也能理解上下文。</p>


            

            
        
    



    
        <title>IoT and smart homes</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">物联网和智能家居</h1>
                
            
            
                
<p>我的一个密友总是担心他年迈的母亲，当他、他的妻子和孩子们外出时，她独自留在家里。随着她的健康状况开始恶化，他向她征求建议。解决办法很简单；他在所有房间都安装了闭路电视摄像头，与一个移动应用程序连接。这些摄像头被连接到互联网上，现在，无论他在哪里，他都可以在家里签到，以确保他母亲的安康。</p>
<p class="mce-root"/>
<p>连接到互联网的闭路电视、智能闪电、智能音箱等等帮助自动化了家里的很多任务，你得到的就是一个智能家居。目前大多数智能家居系统通过语音命令界面工作，在这里你可以使用一组命令来控制特定的设备。例如，在亚马逊的 Echo Dot 中，你可以要求它搜索或播放特定的歌曲。你可以让苹果的 Siri 用你的手机给朋友打电话，全靠简单的语音界面。这些设备中的大多数都以某种形式使用 AI/ML，但是家庭自动化可以通过使用 AI/ML 来进一步发展。例如，在我朋友的情况下，可以训练一个人工智能系统从视频中识别活动，或检测家中的入侵。可能性是无限的。有了正确的数据和足够的计算能力，你只受你的想象力的限制。</p>
<p>在这一部分，我们将看到一些现有的家庭自动化产品，并了解我们如何进一步使用人工智能来增强自动化。</p>


            

            
        
    



    
        <title>Human activity recognition</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">人类活动识别</h1>
                
            
            
                
<p>研究最多的智能家居应用之一是<strong>人体活动识别</strong> ( <strong> HAR </strong>)。有许多公司试图开发跟踪身体活动及其相应卡路里燃烧计数的应用程序。健康和健身无疑是大生意。除了在健身和健康方面的应用，HAR 还可以用于老年人护理或康复中心。有许多方法来执行 HAR，其中两种如下:</p>
<ul>
<li>使用摄像机(或雷达或类似设备)记录人类活动，并使用 DL 方法对其进行分类</li>
<li>个人使用可穿戴传感器(类似于智能手机中的加速度计)，其数据被记录并用于预测活动</li>
</ul>
<p>这两种方法各有利弊。我们将在接下来的小节中更详细地讨论它们。</p>
<p class="mce-root"/>


            

            
        
    



    
        <title>HAR using wearable sensors</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">使用可穿戴传感器的 HAR</h1>
                
            
            
                
<p>大量供应商都有带健身追踪器的可穿戴手表和手环。这些手表和手镯具有 GPS、加速度计、陀螺仪、心率传感器和/或环境光传感器。利用<strong>传感器融合</strong>，他们结合这些传感器的输出，做出关于活动的预测。由于数据的时间性质，这是一项具有挑战性的时间序列分类任务。</p>
<p>健身追踪器领域的顶级公司 fitbit(<a href="https://www.fitbit.com/smarttrack">https://www.fitbit.com/smarttrack</a>)使用了一种称为<strong> SmartTrack </strong>的技术，可以识别持续运动或轻微运动的活动。它使用运动的强度和模式来对活动进行分类。它将活动分为以下七类:</p>
<ul>
<li>步行</li>
<li>运转</li>
<li>有氧运动</li>
<li>椭圆的</li>
<li>户外自行车</li>
<li>运动</li>
<li>游泳</li>
</ul>
<p>苹果手表(<a href="https://www.apple.com/in/apple-watch-series-4/workout/">https://www.apple.com/in/apple-watch-series-4/workout/</a>)给 Fitbit 带来了激烈的竞争。在 IOs 操作系统上工作，它带有跌倒检测功能，以及许多其他健康跟踪功能。通过分析手腕轨迹和冲击加速度，它可以检测到人是否正在坠落，还可以发起紧急呼叫。默认情况下，Apple watch 将活动分为三组:行走、锻炼和站立。运动(锻炼)在另一个领域被进一步分类，例如室内跑步、室外跑步、滑雪、单板滑雪、瑜伽，甚至徒步旅行。</p>
<p>如果你想尝试使用智能手机传感器制作一个类似的应用程序，你首先需要的是数据。下面，我们介绍一个使用随机森林的 HAR 实现，代码改编自罗彻斯特大学数据科学家 Nilesh Patil 的 GitHub 链接:<a href="https://github.com/nilesh-patil/human-activity-recognition-smartphone-sensors">https://GitHub . com/Nilesh-Patil/human-activity-recognition-smart phone-sensors</a>。</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>数据集来自大卫·安吉塔、亚历山德罗·吉奥、卢卡·奥内托、泽维尔·帕拉和豪尔赫·l·雷耶斯-奥尔蒂斯的论文。使用智能手机进行人类活动识别的公共领域数据集。第 21 届欧洲人工神经网络、计算智能和机器学习研讨会，ESANN 2013。2013 年 4 月 24 日至 26 日，比利时布鲁日。 <br/>可在 UCI ML 网站获得:<a href="https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones#">https://archive . ics . UCI . edu/ML/datasets/Human+Activity+Recognition+Using+smart phones #</a>。<br/></p><p>对于数据集中的每条记录，包含:</p>
<ul>
<li>来自加速度计的三轴加速度(总加速度)和估计的车身加速度</li>
<li>陀螺仪的三轴角速度</li>
<li>具有时域和频域变量的 561 特征向量</li>
<li>它的活动标签</li>
<li>进行实验的受试者的标识符</li>
</ul>

<p class="mce-root">数据分为六类:</p>
<ul>
<li>放置</li>
<li>坐着的</li>
<li>直立的</li>
<li>步行</li>
<li>步行</li>
<li>无电梯</li>
</ul>
<ol>
<li>这里，我们使用 scikit-learn 的随机森林分类器对数据进行分类。实施所需的必要模块在第一步导入:</li>
</ol>
<pre style="padding-left: 60px">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/><br/>from sklearn.ensemble import RandomForestClassifier as rfc<br/>from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import accuracy_score<br/>%matplotlib inline</pre>
<ol start="2">
<li>我们读取数据并将其分为<kbd>train</kbd>和<kbd>test</kbd>数据集，如下所示:</li>
</ol>
<pre style="padding-left: 60px">data = pd.read_csv('data/samsung_data.txt',sep='|')<br/>train = data.sample(frac=0.7,<br/>        random_state=42)<br/>test = data[~data.index.isin(train.index)]<br/><br/>X = train[train.columns[:-2]]<br/>Y = train.activity</pre>
<ol start="3">
<li>该数据由 561 个特征组成，但并非所有特征都同等重要。我们可以通过制作一个简单的随机森林分类器来选择更重要的特征，并且只选择最重要的特征。在这个实现中，使用两个步骤来完成。最初，我们获得重要特性的列表，并按照重要性降序排列它们。然后通过网格超学习找到数量和特征。曲线中显示了过度调节的结果。我们可以看到，在大约 20 个特征之后，使用下面的代码，在<strong>出袋</strong>(<strong/>)准确性方面没有显著的改进:</li>
</ol>
<pre style="padding-left: 60px">randomState = 42<br/>ntree = 25<br/><br/>model0 = rfc(n_estimators=ntree,<br/>random_state=randomState,<br/>n_jobs=4,<br/>warm_start=True,<br/>oob_score=True)<br/>model0 = model0.fit(X, Y)<br/><br/># Arrange the features in ascending order<br/>model_vars0 = pd.DataFrame(<br/>    {'variable':X.columns,<br/>    'importance':model0.feature_importances_})<br/><br/>model_vars0.sort_values(by='importance',<br/>    ascending=False,<br/>    inplace=True)<br/><br/># Build a feature vector with most important 25 features<br/><br/>n = 25<br/>cols_model = [col for col in model_vars0.variable[:n].values]</pre>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1110 image-border" src="img/192c852f-e7d6-4b50-a10e-07a0fbe2b223.png" style="width:37.92em;height:20.50em;"/></p>
<ol start="4">
<li>我们还可以在下图中看到前 25 项功能的平均重要性:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1111 image-border" src="img/a50b2557-fe4d-4eec-a2b8-ae21cbf41606.png" style="width:45.92em;height:28.33em;"/></p>
<ol start="5">
<li>同样，我们可以超调树参数的数量。这里，我们将自己限制在四个重要特性上:</li>
</ol>
<pre style="padding-left: 60px">n_used = 4<br/>cols_model = [col for col in model_vars0.variable[:n_used].values]\<br/>     + [model_vars0.variable[6]]<br/>X = train[cols_model]<br/>Y = train.activity<br/><br/>ntree_determination = {}<br/>for ntree in range(5,150,5):<br/>    model = rfc(n_estimators=ntree,<br/>        random_state=randomState,<br/>        n_jobs=4,<br/>        warm_start=False,<br/>        oob_score=True)<br/>model = model.fit(X, Y)<br/>ntree_determination[ntree]=model.oob_score_</pre>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1112 image-border" src="img/8ca940bc-92b6-464e-953f-1f6c67d35399.png" style="width:28.67em;height:19.25em;"/></p>
<ol start="6">
<li>因此，我们可以看到，具有大约四个重要特征和<kbd>50</kbd>棵树的随机森林可以给出良好的 OOB 精度。因此，我们的最终模型如下:</li>
</ol>
<pre style="padding-left: 60px">model2 = rfc(n_estimators=50,<br/>    random_state=randomState,<br/>    n_jobs=4,<br/>    warm_start=False,<br/>    oob_score=True)<br/>model2 = model2.fit(X, Y)</pre>
<p class="mce-root"/>
<ol start="7">
<li>这导致了 94%的测试数据准确性。以下是测试数据集的混淆矩阵:</li>
</ol>
<pre style="padding-left: 60px">test_actual = test.activity<br/>test_pred = model2.predict(test[X.columns])<br/>cm = confusion_matrix(test_actual,test_pred)<br/>sns.heatmap(data=cm,<br/>     fmt='.0f',<br/>     annot=True,<br/>     xticklabels=np.unique(test_actual),<br/>     yticklabels=np.unique(test_actual))</pre>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1113 image-border" src="img/5b71c386-b294-4b2f-8887-92cf66ef4cc7.png" style="width:32.67em;height:21.00em;"/></p>
<p>GitHub 资源库<kbd>Chapter09/Human_activity_recognition_using_accelerometer.ipynb</kbd>提供了完整的代码和数据探索。使用加速度计数据的优势在于，它是从可穿戴设备收集的，因此不需要在建筑物上安装。另一个优点是，它是文本数据，因此比视频数据需要更少的计算资源。</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    



    
        <title>HAR from videos</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">视频中的 HAR</h1>
                
            
            
                
<p>另一种检测人类活动的方法是通过视频。在这种情况下，我们将不得不使用一个 DL 模型，如 CNN，以获得良好的结果。伊万·拉普捷夫和芭芭拉·卡普托(<a href="http://www.nada.kth.se/cvap/actions/">http://www.nada.kth.se/cvap/actions/</a>)为分类视频提供了一个很好的数据集。它包含六种类型的动作:在不同的场景中，行走、慢跑、跑步、拳击、挥手和拍手。每个视频都是使用 25 fps 的摄像机录制的。空间分辨率为 160 × 120，平均长度为 4 秒。它总共有 599 个视频，六个类别各有大约 100 个。</p>
<p>视频数据的一个问题是计算量大，因此减少数据集很重要，以下是一些减少数据集的方法:</p>
<ul>
<li>因为颜色在活动中没有作用，所以图像可以从三通道彩色图像转换成二维灰度图像。</li>
<li>视频时长 4 秒，每秒 25 帧，其中大多数帧包含冗余数据，因此我们可以将帧数减少到每秒 5 帧，即 20 帧，而不是(25 × 4 = 100)帧对应一个数据行。(如果每个视频提取的总帧数是固定的就最好了)。</li>
<li>将单个帧的空间分辨率从 160 × 120 降低。</li>
</ul>
<p>接下来，在建模时，我们应该使用三维卷积层。因此，假设每个视频仅拍摄 20 帧，并将每帧的大小减少到 128 × 128，则单个样本将为:20 × 128 × 128 × 1，这对应于单通道的 20 × 128 × 128 的体积。</p>


            

            
        
    



    
        <title>Smart lighting</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">智能照明</h1>
                
            
            
                
<p>当谈论智能家居时，首先想到的家庭自动化应用是使用智能灯。目前存在的大多数智能照明系统都提供了一个选项，可以使用智能手机上的应用程序或通过互联网来控制灯光的开关和亮度。有些还允许你改变颜色/色调。运动检测灯在检测到任何运动后都会自动打开，如今几乎所有家庭都有这种灯:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1114 image-border" src="img/45ffbdaf-d76a-455d-a42c-f3c4ca885eb8.png" style="width:40.25em;height:25.67em;"/></p>
<p>针对听力障碍人士的智能灯会根据情况改变颜色</p>
<p>利用人工智能，我们可以让这些智能灯变得更加智能。在紧急情况下，它们可以被编程为协同工作，并指引你到正确的出口。对于有听力障碍的人来说，智能灯可以用来代替警报，例如，当火警响起时，红灯亮，但当有窃贼时，红灯亮，当有人按门铃时，绿灯亮。在诸如<strong>If This Then than</strong>(<strong>If TTT</strong>)等服务的帮助下，你可以建立更智能、更复杂的支持系统。</p>
<p>IFTTT 提供免费服务来控制您的设备。一个设备(或服务)的动作可以触发一个或多个其他设备。它的使用非常简单，你只需在 IFTTT 网站上创建一个小程序:<a href="https://ifttt.com">https://ifttt.com</a>，你选择想要用作触发器的设备(点击)或服务，并将其与你的 IFTTT 账户链接。接下来，您选择(指向并单击)当触发器被激活时您想要的服务或设备。该网站包含数以千计的预制小程序，使您的工作更容易。</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1117 image-border" src="img/84e7219c-8800-479b-af5b-65fa2780892d.png" style="width:37.67em;height:27.33em;"/></p>
<p>个性化智能照明系统的算法</p>
<p class="mce-root"/>
<p>这些只是你可以用现有的智能灯做什么的一些例子。但是，如果你富有冒险精神，并准备将新的传感器与这些智能灯相结合，你可以为自己建造一个个人灯，一个根据人的精神活动改变其色调/强度的灯。当你感到困倦时，它会变得暗淡，当你工作时，它会变得非常明亮，但当你与朋友交谈和共度时光时，它只是提供了一种令人愉快的色调。听起来很牵强？不尽然，你可以首先使用一种人工智能算法，从视频(或可穿戴健身追踪器)中检测人类活动，并将其分为三类:工作、休闲和睡眠，然后使用其输出来控制智能灯的色调/强度。</p>


            

            
        
    



    
        <title>Home surveillance</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">家庭监控</h1>
                
            
            
                
<p>家庭监控是一个非常有用和非常需要的应用。随着单亲家庭和老年人口的增加，不仅需要外部场所的安全和监控，还需要家庭内部的安全和监控。许多公司正试图利用视频提供室内监控。其中一个成功的实现是由一家名为 deep sight ai labs(<a href="http://deepsightlabs.com">http://deepsightlabs.com</a>)的公司完成的，他们开发了专有软件<strong>super secure</strong>；一个普遍兼容的改造解决方案，可与任何闭路电视系统、任何摄像机、任何分辨率配合使用，并将其变成一个<strong>人工智能智能智能监控解决方案</strong>，以高精度检测潜在威胁，并触发即时警报以拯救生命和保护资产。</p>
<p>当您尝试自己实施家庭监控时，我们在使用视频实施 HAR 中讨论的要点在这里也会有用。</p>
<p>智能家居仍处于起步阶段，主要原因是它们涉及到高昂的拥有成本和互联设备的不灵活性。通常，一个特定的系统完全由一家公司管理。如果由于某种原因公司关闭了，消费者就会陷入困境。解决方案是允许开源家庭自动化硬件和软件。一篇关于家庭自动化领域的挑战和机遇的有趣阅读是微软研究院的一篇文章，<em>野外家庭自动化:挑战和机遇</em>(<a href="https://www.microsoft.com/en-us/research/publication/home-automation-in-the-wild-challenges-and-opportunities/">https://www . Microsoft . com/en-us/Research/publication/Home-Automation-in-the-Wild-Challenges-and-Opportunities/</a>)。</p>
<p class="mce-root"/>
<p class="mce-root"/>


            

            
        
    



    
        <title>Summary</title>
        
        <meta charset="utf-8"/>
    
<!-- kobo-style -->
<script type="text/javascript" src="img/kobo.js"/>
<style type="text/css" id="koboSpanStyle">.koboSpan { -webkit-text-combine: inherit; }</style>



    
        

                            
                    <h1 class="header-title">摘要</h1>
                
            
            
                
<p>本章的重点是个人和家庭人工智能驱动的物联网解决方案。智能手机的大规模使用使每个人都可以接触到可穿戴传感器，导致了大量的个人应用程序。在这一章中，我们探索并实施了一些成功的个人和家庭人工智能物联网解决方案。我们学习了麻省理工学院的超级鞋，这种鞋可以自己找到到达目的地的路径。我们了解了 CGM 系统并实现了预测高血糖的代码。本章还演示了如何实现个性化心脏监护仪。</p>
<p>虽然智能家居仍处于起步阶段，但本章探讨了一些最流行和最有用的智能家居解决方案。介绍了智能家居和个人物联网边界的应用程序 HAR。我们使用 scikit-learn 编写了一些代码，从使用加速度计获得的数据中对活动进行分类。本章介绍了一些很酷的智能照明应用，并讨论了使用视频的家庭监控。</p>
<p>在下一章中，我们将看一些案例研究，从物联网传感器获得的数据用于提高工业生产和效率。</p>


            

            
        
    

</body></html>